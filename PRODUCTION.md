# Kursik Bot - Продакшн Деплой

## Быстрый старт

### 1. Подготовка окружения

```bash
# Клонируем репозиторий
git clone <repository-url>
cd kursik-bot

# Копируем файл с переменными окружения
cp env.example .env

# Редактируем переменные окружения
nano .env
```

### 2. Настройка переменных окружения

Отредактируйте файл `.env`:

```env
# Обязательная переменная
BOT_TOKEN=your_telegram_bot_token_here
```

**Примечание:** Проект использует только переменную `BOT_TOKEN`. База данных SQLite создается автоматически в файле `data.sqlite`, а курсы валют получаются через API Национального банка Беларуси без дополнительной настройки.

### 3. Установка зависимостей и сборка

```bash
# Устанавливаем зависимости
npm install

# Сборка TypeScript проекта
npm run build
```

### 4. Настройка PM2

#### Создание ecosystem файла

Создайте файл `ecosystem.config.js` в корне проекта:

```js
module.exports = {
  apps: [
    {
      name: 'kursik-bot',
      script: 'dist/main.js',
      env: {
        NODE_ENV: 'production',
        BOT_TOKEN: process.env.BOT_TOKEN
      }
    }
  ]
};
```

#### Запуск через PM2

```bash
# Запуск приложения через PM2
pm2 start ecosystem.config.js

# Сохраняем процесс для автозапуска после ребута
pm2 save

# Включаем автозапуск при старте системы
pm2 startup
```

### 5. Управление приложением

```bash
# Просмотр списка процессов
pm2 list

# Просмотр логов
pm2 logs kursik-bot

# Перезапуск
pm2 restart kursik-bot

# Остановка
pm2 stop kursik-bot

# Удаление процесса
pm2 delete kursik-bot
```

### 6. Обновление кода

```bash
# Подтягиваем обновления из Git
git pull origin main
npm install  # если появились новые зависимости

# Перезапуск через PM2
pm2 restart kursik-bot
```

## Структура файлов

```
kursik-bot/
├── src/                 # Исходный код
├── dist/                # Скомпилированный код (создается при сборке)
├── data/                # База данных SQLite
├── Dockerfile           # Конфигурация Docker (не используется при PM2)
├── docker-compose.yml   # Конфигурация Docker Compose (не используется при PM2)
├── deploy.sh           # Скрипт автоматического деплоя (не используется при PM2)
├── env.example         # Пример переменных окружения
└── .env                # Переменные окружения (создать вручную)
```

## Безопасность

* Файл `.env` не должен попадать в git
* Используйте сильные токены для ботов
* Регулярно обновляйте зависимости
* Мониторьте логи на предмет ошибок
